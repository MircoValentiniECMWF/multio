parameter-mappings: ../server/config/parameter-mappings.yaml

plans:
    - name: Test Encode NextGEMS PL sh
      actions:
        - type: select
          match:
            - levtype: pl
              gridType: sh
        - type: print
          prefix: Matched PL sh field
        - type: encode
          format: grib
          template: ../../../eccodes/experimental/templates/sh_pl_grib1.tmpl
        - type: sink
          sinks:
            - type: file
              append: false
              per-server: true # Will give you one file per server
              path: testEncodeNextGEMS-PL-sh.grib
    - name: Test Encode NextGEMS PL gg
      actions:
        - type: select
          match:
            - levtype: pl
              gridType: reduced_gg
        - type: print
          prefix: Matched PL reduced_gg field
        - type: encode
          format: grib
          template: ../../../eccodes/experimental/templates/reduced_gg_pl_grib1.tmpl
        - type: sink
          sinks:
            - type: file
              append: false
              per-server: true # Will give you one file per server
              path: testEncodeNextGEMS-PL-gg.grib
    # - name: Test Encode NextGEMS SFC gg
    #   actions:
    #     - type: select
    #       match:
    #         - levtype: sfc
    #           # gridType: reduced_gg
    #           # gribEdition: 1
    #     - type: parameter-mapping
    #       mapping: grib1-sfc-encoder-overwrites
    #       enforce-match: false
    #       overwrite-existing: true
    #     - type: print
    #       prefix: Matched SFC reduced_gg grib1 field
    #     - type: encode
    #       format: grib
    #       template: ../../../eccodes/experimental/templates/reduced_gg_sfc_grib1.tmpl
    #     - type: sink
    #       sinks:
    #         - type: file
    #           append: false
    #           per-server: true # Will give you one file per server
    #           path: testEncodeNextGEMS-SFC-gg1.grib
    # - name: Test Encode NextGEMS SFC regular_gg
    #   actions:
    #     - type: select
    #       match:
    #         - levtype: sfc
    #           gridType: reduced_gg
    #     - type: print
    #       prefix: Matched SFC field regular_gg
    #     - type: encode
    #       format: grib
    #       template: ../../../eccodes/experimental/templates/reduced_gg_ml_grib1.tmpl
    #     - type: sink
    #       sinks:
    #         - type: file
    #           append: false
    #           per-server: true # Will give you one file per server
    #           path: testEncodeNextGEMSSFC.grib
    - name: Test Encode NextGEMS SFC litota
      actions:
        - type: select
          match:
            - levtype: sfc
              param: [228051]
        - type: parameter-mapping
          mapping: grib1-sfc-encoder-overwrites
          enforce-match: false
          overwrite-existing: true
        - type: print
          prefix: Matched SFC field 228051 (litota1)
        - type: encode
          format: grib
          # template: /Users/mapg/tmp/nextgems-input-SFC.grib
          # template: /Users/mapg/tmp/nextgems-input-SFC.grib
          template: /Users/mapg/tmp/nextgems-input-SFC-litota1.grib
          # template: ../server/config/unstr_inst_fc.tmpl
        - type: sink
          sinks:
            - type: file
              append: false
              per-server: true # Will give you one file per server
              path: testEncodeNextGEMSSFC-litota1.grib
    # - name: Test Encode NextGEMS SFC sd
    #   actions:
    #     - type: select
    #       match:
    #         - levtype: sfc
    #           param: [141]
    #     - type: print
    #       prefix: Matched SFC sd
    #     - type: encode
    #       format: grib
    #       template: /Users/mapg/tmp/nextgems-input-SFC-sd.grib
    #     - type: sink
    #       sinks:
    #         - type: file
    #           append: false
    #           per-server: true # Will give you one file per server
    #           path: testEncodeNextGEMSSFC-sd.grib
    # - name: Test Encode NextGEMS SFC sithick
    #   actions:
    #     - type: select
    #       match:
    #         - levtype: sfc
    #           param: [174098]
    #     - type: print
    #       prefix: Matched SFC sithick
    #     - type: encode
    #       format: grib
    #       template: /Users/mapg/tmp/nextgems-input-SFC-sithick.grib
    #     - type: sink
    #       sinks:
    #         - type: file
    #           append: false
    #           per-server: true # Will give you one file per server
    #           path: testEncodeNextGEMSSFC-sithick.grib
    - name: Test Encode NextGEMS SFC different top/bottom level
      actions:
        - type: select
          match:
            - levtype: sfc
              param: [141, 139, 170, 183, 236, 39, 40, 41, 42]
        - type: parameter-mapping
          mapping: grib1-sfc-encoder-overwrites
          enforce-match: false
          overwrite-existing: true
        - type: print
          prefix: Matched SFC different top/bottom level
        - type: encode
          format: grib
          # template: /Users/mapg/tmp/nextgems-input-SFC.grib
          # template: /Users/mapg/tmp/nextgems-input-SFC.grib
          # template: /Users/mapg/tmp/nextgems-input-SFC-sd.grib
          template: /Users/mapg/tmp/nextgems-input-SFC-stl4.grib
          # template: ../server/config/unstr_inst_fc.tmpl
        - type: sink
          sinks:
            - type: file
              append: false
              per-server: true # Will give you one file per server
              path: testEncodeNextGEMSSFC-others.grib
    - name: Test Encode NextGEMS SFC rest
      actions:
        - type: select
          match:
            - levtype: sfc
              # param: [8, 9, 31, 33, 34, 39, 40, 41, 42, 129, 134, 139, 141, 144, 146, 147, 151, 165, 166, 167, 168, 169, 170, 172, 175, 176, 177, 178, 179, 183, 228, 235, 236, 228051, 212, 98.174, 79, 78, 137, 228089, 228090, 228021, 164, 181, 180, 195, 196, 228246, 228247, 228029]
          ignore:
            - param: [228051, 141, 139, 170, 183, 236, 39, 40, 41, 42, 174098]
            # - param: [228051]
        - type: parameter-mapping
          mapping: grib1-sfc-encoder-overwrites
          enforce-match: false
          overwrite-existing: true
        - type: print
          prefix: Matched SFC field rest
        - type: encode
          format: grib
          template: /Users/mapg/tmp/nextgems-input-SFC-rsn.grib
          # template: ../../../eccodes/experimental/templates/reduced_gg_sfc_grib1.tmpl
        - type: print 
        - type: sink
          sinks:
            - type: file
              append: false
              per-server: true # Will give you one file per server
              path: testEncodeNextGEMSSFC.grib
              
              
