
transport : mpi
group : world
serverCount : 3
clientCount : 5

activeFields :
  - lat_T
  - lon_T
  - lat_U
  - lon_U
  - lat_V
  - lon_V
  - lat_W
  - lon_W
  # - ssh
  # - toce
  - sst
  # - soce
  # - sss
  # - uoce
  - ssu
  # - voce
  - ssv
  # - woce
  - ssw

plans :

  - name : ocean-grids
    actions:
      - type : Select
        match : category
        categories : [ocean-grid-coordinate]

      - type : Aggregation

      - type : Encode
        format : grib
        template : unstructured.tmpl
        grid-type : eORCA1

      - type : Sink
        sinks :

          - type : file
            append : false
            path : /var/tmp/ocean-pipe.grib

  - name : ocean-instant
    actions :
      - type : Select
        match : category
        categories : [ocean-model-level]

      - type : Aggregation

      # - type : SingleFieldSink
      #   root_path : "/scratch/ma/masd/ocean-fields/"

      - type : Statistics
        output_frequency: 6h
        operations:
          - average

      - type : Encode
        format : grib
        template : unstructured.tmpl
        grid-type : eORCA1

      - type : Sink
        sinks :

          - type : file
            append : true
            path : /var/tmp/ocean-pipe.grib

  # - name : ocean-hourly
  #   actions :
  #     - type : Select
  #       match : field
  #       items : [sst, sss]

  #     - type : Statistics
  #       output_frequency: 1h
  #       operations:
  #         - average
  #         - minimum
  #         - maximum

  #     - type : Aggregation

  #     # - type : SingleFieldSink
  #     #   root_path : "/scratch/ma/masd/ocean-fields/"

  #     - type : Encode
  #       format : grib
  #       template : unstructured.tmpl

  #     - type : Sink
  #       sinks :
  #         - type : fdb5
  #           config : {}
