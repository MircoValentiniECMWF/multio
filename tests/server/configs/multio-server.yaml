
transport : mpi
group : world
serverCount : 3
clientCount : 5

activeFields :
  - lat_T
  - lon_T
  - lat_U
  - lon_U
  - lat_V
  - lon_V
  - lat_W
  - lon_W
  # - ssh
  # - toce
  - sst
  # - soce
  # - sss
  # - uoce
  - ssu
  # - voce
  - ssv
  # - woce
  - ssw

plans :

  - name : ocean-grids
    actions:
      - type : Select
        match : category
        categories : [ocean-grid-coordinate]

      - type : Aggregation

      - type : Encode
        format : grib
        template : unstructured.tmpl
        grid-type : eORCA1

      - type : Sink
        sinks :

          - type : file
            append : false
            path : /var/tmp/ocean-pipe.grib

          - type : fdb5
            config : {}

  - name : ocean-surface
    actions :
      - type : Select
        match : category
        categories : [ocean-model-level]

      - type : Aggregation

      - type : Statistics
        output_frequency: 3h
        operations:
          - average

      - type : Encode
        format : grib
        template : unstructured.tmpl
        grid-type : eORCA1

      - type : Sink
        sinks :

          - type : file
            append : true
            path : /var/tmp/ocean-pipe.grib

          - type : fdb5
            config : {}
